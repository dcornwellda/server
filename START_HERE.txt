# START HERE - Remote Instrument Server

## ğŸ“¦ What You Have

A complete FastAPI server for remote control of:
- **Keithley 2015** Multimeter (GPIB/USB/Serial)
- **QA402** Audio Analyzer (REST API)

## ğŸš€ Three Steps to Get Running

### 1. Run Setup (First Time Only)
Double-click: **setup.bat**

This will install all required Python packages.

### 2. Start the Server
Double-click: **start_server.bat**

Server will start at: http://localhost:8000

### 3. Open Documentation
Open browser: **http://localhost:8000/docs**

Interactive API documentation with "Try it out" buttons!

## ğŸ“ File Structure

```
instrument_server/
â”‚
â”œâ”€â”€ ğŸ“„ start_server.bat      â† Double-click to start server
â”œâ”€â”€ ğŸ“„ setup.bat             â† Double-click for first-time setup
â”œâ”€â”€ ğŸ“„ QUICKSTART.md         â† 5-minute quick start guide
â”œâ”€â”€ ğŸ“„ README.md             â† Full documentation
â”‚
â”œâ”€â”€ ğŸ“„ main.py               â† Server entry point
â”œâ”€â”€ ğŸ“„ requirements.txt      â† Python dependencies
â”œâ”€â”€ ğŸ“„ example_client.py     â† Python client examples
â”‚
â”œâ”€â”€ ğŸ“ api/                  â† API endpoints
â”‚   â”œâ”€â”€ keithley_routes.py   (Keithley REST API)
â”‚   â””â”€â”€ qa402_routes.py      (QA402 REST API)
â”‚
â”œâ”€â”€ ğŸ“ services/             â† Business logic
â”‚   â”œâ”€â”€ keithley_service.py
â”‚   â””â”€â”€ qa402_service.py
â”‚
â””â”€â”€ ğŸ“ devices/              â† Instrument drivers
    â”œâ”€â”€ keithley2015.py      (VISA driver)
    â””â”€â”€ qa402.py             (REST client)
```

## âš¡ Quick Test

After starting the server, test the connection:

### Keithley Test
1. Go to: http://localhost:8000/docs
2. Find: **POST /keithley/connect**
3. Click "Try it out"
4. Enter your GPIB address (e.g., "GPIB0::15::INSTR")
5. Click "Execute"

### QA402 Test
1. **Start QA402 application first!**
2. Find: **POST /qa402/connect**
3. Click "Try it out"
4. Click "Execute"

## ğŸŒ Remote Access

To access from your local PC:

1. Find your remote PC's IP address:
   ```cmd
   ipconfig
   ```

2. On local PC, open browser:
   ```
   http://<remote-pc-ip>:8000/docs
   ```

3. If connection fails, allow port 8000 in Windows Firewall:
   ```cmd
   netsh advfirewall firewall add rule name="Instrument Server" dir=in action=allow protocol=TCP localport=8000
   ```

## ğŸ“– Documentation Files

- **QUICKSTART.md** - Get started in 5 minutes
- **README.md** - Complete documentation
- **example_client.py** - Python client library and examples

## ğŸ”§ Finding Your Keithley Address

Before connecting, you need to find your instrument's VISA address:

```cmd
python
>>> import pyvisa
>>> rm = pyvisa.ResourceManager()
>>> print(rm.list_resources())
```

Look for something like:
- `GPIB0::15::INSTR` (GPIB)
- `USB0::0x05E6::0x2015::...::INSTR` (USB)
- `ASRL1::INSTR` (Serial)

## ğŸ“Š Example Measurements

### Measure DC Voltage (Keithley)
```
POST /keithley/measure/voltage/dc
Body: {"range_value": null}
```

### Get THD (QA402)
```
POST /qa402/data/thd
Body: {"channel": "left"}
```

### Configure Generator (QA402)
```
POST /qa402/configure/generator
Body: {
  "frequency_hz": 1000,
  "level_dbv": -10,
  "enabled": true
}
```

## â“ Need Help?

1. **Can't connect to Keithley?**
   - Check NI-VISA is installed
   - Verify GPIB address
   - Test with NI MAX tool

2. **Can't connect to QA402?**
   - Make sure QA402 application is running
   - Check http://localhost:9402 works

3. **Can't access from remote PC?**
   - Check Windows Firewall
   - Verify both PCs on same network
   - Test with http://<server-ip>:8000

## ğŸ¯ Next Steps

1. âœ… Run setup.bat
2. âœ… Start server with start_server.bat
3. âœ… Open http://localhost:8000/docs
4. âœ… Connect to instruments
5. âœ… Try measurements
6. âœ… Access from remote PC
7. âœ… Use example_client.py for automation

---

**Ready to start?** â†’ Double-click **setup.bat** then **start_server.bat**

**Questions?** â†’ Read **QUICKSTART.md** or **README.md**

**Want automation?** â†’ See **example_client.py**
